
?cvFolds
ff <- cvFolds(10, K = 5)
ff
attributes(ff)
attr(ff, "subsets")
ff["subsets"]
ff
ff["which"]
ff <- cvFolds(4, K = 5)
ff <- cvFolds(5, K = 5)
ff
?createFolds
library(caret)
iris
split<-createDataPartition(y = mtcars$mpg, p = 0.6, list = FALSE)
dev<-mtcars[split,]
val<-mtcars[-split,]
dev
val
length(dev)
nrow(dev)
nrow(val)
lmFit <- train(mpg ~ ., data = dev, method = "lm")
lmFit
data(iris)
cvFit(rpart, formula=Species~., data=iris,
cost=function(y, yHat) (y != yHat) + 0, predictArgs=c(type='class'))
install.packages("rpart")
data(iris)
cvFit(rpart, formula=Species~., data=iris,
cost=function(y, yHat) (y != yHat) + 0, predictArgs=c(type='class'))
library(rpart)
data(iris)
cvFit(rpart, formula=Species~., data=iris,
cost=function(y, yHat) (y != yHat) + 0, predictArgs=c(type='class'))
data(iris)
cvFit(rpart, formula=Species~., data=iris,
cost=function(y, yHat) (y != yHat) + 0, folds = 5, predictArgs=c(type='class'))
?cvFit
f <- cvFit(rpart, formula=Species~., data=iris, cost=function(y, yHat) (y != yHat) + 0, predictArgs=c(type='class'))
f
summary(f)
f <- cvFit(rpart, formula=Species~., data=iris,  predictArgs=c(type='class'))
f <- cvFit(rpart, formula=Species~., data=iris)
f
3
4
5
6
7
8
9
10
11
12
# load the library
library(caret)
# load the iris dataset
data(iris)
# define training control
train_control <- trainControl(method="cv", number=10)
train_contro;
train_control
model <- train(Species~., data=iris, trControl=train_control, method="rf")
model <- train(Species~., data=iris, trControl=train_control, method="rf")
install.packages("e1071")
model <- train(Species~., data=iris, trControl=train_control, method="rf")
model
summary(model)
library(caret)
?createFolds
y <- 1:10
createFolds(y, 5)
createFolds(y, 10)
createFolds(y, 15)
createFolds(y, 3)
createFolds(y)
createFolds(1:100)
f <- cvFit(rpart, formula=Species~., data=iris, cost=function(y, yHat) (y != yHat) + 0, predictArgs=c(type='class'))
f
attributes(f)
f["cv"]
f["se"]
?train
?randomForest
model <- train(Species~., data=iris, trControl=train_control, method="rf", ntree=50)
summary(model)
model
model <- train(Species~., data=iris, trControl=train_control, method="rf", ntree=50, mtry=3)
model <- train(Species~., data=iris, trControl=train_control, method="rf", ntree=50, tuneGrid = data.frame(.mtry = M))
model <- train(Species~., data=iris, trControl=train_control, method="rf", ntree=50, tuneGrid = data.frame(.mtry = 3))
model
train
model <- train(Species~., data=iris, trControl=train_control, method="rf", ntree=50, tuneGrid = data.frame(.mtry = 3), k = 0)
?train
model <- train(Species~., data=iris, trControl=train_control, method="rf", ntree=50, tuneGrid = data.frame(.mtry = 3))
class(model)
attributes(model)
attributes(model$method)
?randomForest
summary(model)
mode$importance
mode$ntree
model$importance
model$finalModel
?trainControl
createFolds
cvFolds(1:20, K = 5)
?cvFolds
cvFolds(20, K = 5)
ff <- cvFolds(20, K = 5)
ff[1]
ff[2]
ff[3]
ff[34]
ff[4]
ff
ff$Fold
ff[["Fold"]]
?cvFolds
model$finalModel
?cvit
cvFit
?cvFit
?predict.randomForest
?predict.rpart
?predict.randomForest
?predict.rpart
?predict.glmrob
?predict.bag
?predict.avNNet
?predict.bagEarth
?randomForest
svm
?svm
# original example from Digg Data website (Takashi J. OZAKI, Ph. D.)
# http://diggdata.in/post/58333540883/k-fold-cross-validation-in-r
library(plyr)
library(randomForest)
data <- iris
# in this cross validation example, we use the iris data set to
# predict the Sepal Length from the other variables in the dataset
# with the random forest model
k = 5 #Folds
# sample from 1 to k, nrow times (the number of observations in the data)
data$id <- sample(1:k, nrow(data), replace = TRUE)
list <- 1:k
# prediction and testset data frames that we add to with each iteration over
# the folds
prediction <- data.frame()
testsetCopy <- data.frame()
#Creating a progress bar to know the status of CV
progress.bar <- create_progress_bar("text")
progress.bar$init(k)
for (i in 1:k){
# remove rows with id i from dataframe to create training set
# select rows with id i to create test set
trainingset <- subset(data, id %in% list[-i])
testset <- subset(data, id %in% c(i))
# run a random forest model
mymodel <- randomForest(trainingset$Sepal.Length ~ ., data = trainingset, ntree = 100)
# remove response column 1, Sepal.Length
temp <- as.data.frame(predict(mymodel, testset[,-1]))
# append this iteration's predictions to the end of the prediction data frame
prediction <- rbind(prediction, temp)
# append this iteration's test set to the test set copy data frame
# keep only the Sepal Length Column
testsetCopy <- rbind(testsetCopy, as.data.frame(testset[,1]))
progress.bar$step()
}
# add predictions and actual Sepal Length values
result <- cbind(prediction, testsetCopy[, 1])
names(result) <- c("Predicted", "Actual")
result$Difference <- abs(result$Actual - result$Predicted)
# As an example use Mean Absolute Error as Evalution
summary(result$Difference)
result
createFolds(1:20)
ff <- createFolds(1:20)
ff[[1]]
-ff[[1]]
ff <- createFolds(1:20, K = 7)
ff <- createFolds(1:20, k = 7)
ff
createFolds
library(devtools)
install.packages("devtools")
devtools::use_package("caret")
ff <- createFolds(1:20, k = 5, returnTrain = T)
ff
ff <- createFolds(1:20, k = 5, returnTrain = F)
ff
?cvFit
?train
?dvm
?svm
?randomForest
install.packages("ada")
?ada
library(ada)
?ada
?train
colnames(feat_vec)
colnames(feat_vec)[3:6]
train(feat_vec[, colnames(feat_vec)[3:6]], feat_vec[, "label"], method="rf")
train(feat_vec[, colnames(feat_vec)[3:6]], feat_vec[, "lbl_col"], method="rf")
train(feat_vec[, 3:6], feat_vec[, "lbl_col"], method="rf")
sapply(feat_vec, class)
train(feat_vec[, 3:6], as.factor(feat_vec[, "lbl_col"]), method="rf")
warnings()
train(feat_vec[, 3:6], as.factor(feat_vec[, "lbl_col"]), method="svm")
train(feat_vec[, 3:6], as.factor(feat_vec[, "lbl_col"]), method="svmLinear")
warnings()
is.formula
plyr::is.discrete
plyr::is.formula
source('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/crossvalidation.R')
label_cset
ll <- label_cset[1:5, -unlist(label_cset@key)]
ll <- label_cset[1:5, -(unlist(label_cset@key))]
which(colnames(label_cset), unlist(label_cset@key))
match(colnames(label_cset), unlist(label_cset@key))
grep(colnames(label_cset), unlist(label_cset@key))
grep(unlist(label_cset@key), colnames(label_cset))
?match
unlist(label_cset@key) %in% colnames(label_cset)
match(colnames(label_cset), unlist(label_cset@key), nomatch=0)
match(colnames(label_cset), unlist(label_cset@key), nomatch=NULL)
length(match(colnames(label_cset), unlist(label_cset@key)))
?createFolds
library(QPackage)
data(walmart_bk_dataset)
data(bowker_bk_dataset)
c1 <- colnames(w)
<- walmart_bk_dataset
b <- bowker_bk_dataset
w <- walmart_bk_dataset
b <- bowker_bk_dataset
c1 <- colnames(w)
c2 <- colnames(b)
cmn <- setdiff(intersect(c1, c2), c(unlist(w@key), unlist(b@key))
)
lapply(cmn. rep, 2)
lapply(cmn, rep, 2)
l <- list(c("title", "title"), c("brand", "brand"))
l
attrs <- attr_corres[[1]]
attr_corres = NULL
if(is.null(attr_corres)) {
c1 <- colnames(w)
c2 <- colnames(b)
cmn <- setdiff(intersect(c1, c2), c(unlist(w@key), unlist(b@key)))
attr_corres <- lapply(cmn, rep, 2)
}
attrs <- attr_corres[[1]]
type(w[, attrs[1]]) == type(w[, attrs[2]])
class(w[, attrs[1]])
word_len <- function(s) {
length(strsplit(s, " "))
}
len1 <- lapply(w[, attrs[1]], word_len)
len2 <- lapply(b[, attrs[1]], word_len)
mean(len1)
len1[1:2]
mean(unlist(len1) )
len1 <- sapply(w[, attrs[1]], word_len)
len1[1:5]
len1 <- sapply(w[, attrs[1]], word_len, simplify=T)
len1 <- sapply(w[, attrs[1]], word_len, simplify=F)
len1[1:5]
?vapply
len1 <- vapply(w[, attrs[1]], word_len)
len1 <- apply(w[, attrs[1]], 1, word_len)
len1 <- lapply(w[, attrs[1]], word_len)
len1 <- unlist(len1)
mean(len1)
len1[1:10]
lapply(c("muruga sar", "saranam mur"), word_len)
strsplit("muruga sar", " ")
length(unlist(strsplit("muruga sar", " ")))
word_len <- function(s) {
length(unlist(strsplit(s, " ")))
}
len1 <- lapply(w[, attrs[1]], word_len)
len1 <- unlist(len1)
mean(len1)
median(len1)
a <- list()
b <- list()
b[1] <- list("lev")
b[2] <- list("jaccard", "tok_whitespace", NULL, "tok_whitespace", NULL)
b[3] <- list("jaccard", "tok_qgram", 3, "tok_qgram", 3)
a[["mws"]] <- b
b[[1]] <- list("lev")
b[[2]] <- list("jaccard", "tok_whitespace", NULL, "tok_whitespace", NULL)
b[[3]] <- list("jaccard", "tok_qgram", 3, "tok_qgram", 3)
a[["mws"]] <- b
a
a["mws"] <- b
a$mws <- b
a
a$mws[[1]] <- list("lev")
a
a$mws[1] <- list("lev")
a$mws
a$mws[1] <- list("lev")
a$mws[2] <- list("jaccard", "tok_whitespace", NULL, "tok_whitespace", NULL)
a$mws[3] <- list("jaccard", "tok_qgram", 3, "tok_qgram", 3)
b <- list()
b[[1]] <- list("lev")
b[[2]] <- list("jaccard", "tok_whitespace", NULL, "tok_whitespace", NULL)
b[[3]] <- list("jaccard", "tok_qgram", 3, "tok_qgram", 3)
a$mws <- b
kk <- a$mws
kk[[1]]
kk[[2]]
"tok_whitespace" %in% kk[[2]]
"tok_whitespace2" %in% kk[[2]]
check_valid <- function(s, simlist, toklist) {
if(any(s `%in` simlist) {
return(NULL)
}
if(any(s `%in` toklist))
return(NULL)
return(unlist(s))
}
check_valid <- function(s, simlist, toklist) {
if(any(s %in% simlist) {
return(NULL)
}
if(any(s %in% toklist))
return(NULL)
return(unlist(s))
}
check_valid <- function(s, simlist, toklist) {
if(any(s %in% simlist) {
=======

tok_qgram("muruga saranam",2)
tok_qgram("muruga saranam",2)
library(QPackage)
tok_qgram("muruga saranam",2)
tok_qgram("muruga saranam",2)
tokenizer
.jrcall(tokenizer, "whitespaceTokenizer", "muru")
.jrcall(tokenizer, "whitespaceTokenizer", "muru saranam")
.jrcall(tokenizer, "qgramTokenizer", "muru saranam")
.jrcall(tokenizer, "qgramTokenizer", "muru saranam", 2)
.jrcall(tokenizer, "qgramTokenizer", "muru saranam", 2)
.jrcall(tokenizer, "qgramTokenizer", "muru saranam", "2")
.jrcall(tokenizer, "qgramTokenizer", "muru saranam", 10)
.jrcall(tokenizer, "qgramTokenizer", "muru saranam", 3)
.jcall(tokenizer, "D", qgramTokenizer", "muru saranam", 3)
.jcall(tokenizer, "D", qgramTokenizer", "muru saranam", 1=3)
.jcall(tokenizer, "D", qgramTokenizer", "muru saranam", q=3)
.jrcall(tokenizer, "qgramTokenizer", "muru saranam", q=)
.jrcall(tokenizer, "qgramTokenizer", s="muru saranam", q=)
.jrcall(tokenizer, "qgramTokenizer", s="muru saranam", q=2)
.jrcall(tokenizer, "qgramTokenizer", "muru saranam", q=2)
.jrcall(tokenizer, "qgramTokenizer", "muru saranam", 2)
.jrcall(tokenizer, "qgramTokenizer", "muru saranam")
.jcall(tokenizer, "D", qgramTokenizer", "muru saranam", 2)
?.jcall
.jcall(tokenizer, "D", "qgramTokenizer", "muru saranam", 2)
.jcall(tokenizer, "S[", "qgramTokenizer", "muru saranam", 2)
.jcall(tokenizer, "S[[", "qgramTokenizer", "muru saranam", 2)
.jrcall(tokenizer,  "qgramTokenizer", "muru saranam", 2)
.jcall(tokenizer, "[S", "whitespaceTokenizer", "muruga saranam")
.jcall(tokenizer, "[S", "qgramTokenizer", "muruga saranam", 2)
library(QPackage)
tok_qgram("muruga saranam", 2)
.jrcall(tokenizer, "qgramTokenizer", s, q)
library(QPackage)
tok_whitespace("muruga saranam")
library(QPackage)
tok_whitespace("muruga saranam")
tok_qgram("muruga saranam", 2)
i<- 10
is.array(i)
is.vector(i)
i <- list(10)
is.vector(i)
library(QPackage)
t1 <- tok_whitespace("muruga saranam")
t2 <- tok_whitespace("saranam saranam")
jaccard(t1, t2)
jaccard(t1, t2)
s1
s2
s1 == NULL
jaccard(t1, t2)
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/similarity-functions.R')
jaccard(t1, t2)
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/similarity-functions.R')
jaccard(t1, t2)
library(QPackage)
jaccard(t1, t2)
jaccard(t1, t2)
jaccard(t1, t2)
d1 = 10
d1 = d2 = 0
(d1-d2)/max(d1, d2)
abs((d1-d2)/max(d1, d2))
diff_vals(10, 20)
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/similarity-functions.R')
diff_vals(10, 20)
adist(10, 20)
lev(10, 20)
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/similarity-functions.R')
lev(10, 20)
lev(10, 20)
adist(10, "")
adist(10, NA)
adist(10, NULL)
adist(NULL, NULL)
s <- "jac_1"
"jac_1" <- function(a, b) { return(a+b)}
jac_1(5, 10)
as.character(substitute(s)) <- function(a, b) { return(a+b)}
(substitute(s)) <- function(a, b) { return(a+b)}
substitute(s) <- function(a, b) { return(a+b)}
deparse(substitute(s)) <- function(a, b) { return(a+b)}
deparse(substitute(s))
`deparse(substitute(s))`
kk<-deparse(substitute(s))
`kk`
`kk` <- function(a, b) { return a + b}
assign(kk, function(a, b) { return(a + b)})
kk(10, 5)
assign(`kk`, function(a, b) { return(a + b)})
s(10, 5)
assign(kk, function(a, b) { return(a + b)})
kk(5, 10)
s(10, 6)
s <- "jac_1"
assign(deparse(substitute(s)), function(a, b) { return(a+b)})
jac_1(10, 5)
fn <- function(a, b) { return (a-b)}
assign(deparse(substitute(s)), fn)
jac_1(10, 5)
assign(deparse(substitute(s)), function(a, b) { return(a-b)})
jac_1(10, 5)
s <- "jac_1"
assign(deparse(substitute(s)), function(a, b) { return(a-b)})
s(10, 5)
jac_1(10, 5)
assign("jac_1", function(a, b) { return(a-b)})
jac_1(10, 5)
assign("jac_1", function(a, b) { return(a*b)})
jac_1(10, 5)
fn <- function(a, b) {}
fn <- function(a, b) { return(2*a + b)}
assign("jac_1", fn)
jac_1(10, 5)
fn <- function(a, b) { return(2*a + b)}
assign("jac_1", fn)
k = list()
k[[1]] = "10"
k[[2]] = "20"
k
k[[5]] = "40"
k
parse("jac_1")
deparse("jac_1")
substitute("jac_1")
ll <- assign("jac_1", fn)
ll
substitute(ll)
as.symbol("jac_1")
get_fn_list <- function() {
list_fns <- list()
s <- "jac_1"
fn <- function(a, b) { return(a +b)}
assign(deparse(substitute(s)), fn)
list_fns[[1]] <- as.symbol(deparse(substitute(s)))
s <- "jac_2"
fn <- function(a, b) { return(a - b)}
assign(deparse(substitute(s)), fn)
list_fns[[1]] <- as.symbol(deparse(substitute(s)))
>>>>>>> Stashed changes
}
ret <- fn_1(d1, d2, fn_list)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
library(QPackage)
ret <- fn_1(d1, d2, fn_list)
merged_tuple
?lapply
col_names_a
col_names_b
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
merged_tuple
class(merged_tuple)
col_names_a
sapply(merged_d, typeof)
ml <- as.list(merged_d)
ml
ml[1, ]
names(ml)
ml$title
ml$title[1]
library(QPackage)
ret <- fn_1(d1, d2, fn_list)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
t
t$id
t
is.list(t)
as.list(t)
is.data.frame(t)
type(t)
typeof(t)
tl <- as.list(t)
tl
t
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
t
tl <- as.list(t)
tl
tl$price <- as.factor(tl$price)
tl$price <- as.numeric(tl$price)
tl
typeof(tl$price)
tl
lapply(tl, typeod)
lapply(tl, typeof)
tl
td <- as.data.frame(tl)
td
apply(td, 1, typeof)
td$price
td$price.1
as.numeric(td$price.1)
td$price
td$price.1
as.numeric(td$price.1)
?as.data.frame
tl
td <- as.data.frame(tl, stringsAsFactors=FALSE)
tf
td
td
td$price.
td$price.1
as.numeric(td$price.1)
convert.magic1 <- function(obj,types){
out <- lapply(1:length(obj),FUN = function(i){FUN1 <- switch(types[i],character = as.character,numeric = as.numeric,factor = as.factor); FUN1(obj[,i])})
names(out) <- colnames(obj)
as.data.frame(out)
}
merged_d
merged_d[1, ]
as.character(merged_d[1, ])
t1
tl
merged_d
sapply(merged_d, class)
sapply(merged_d, type)
sapply(merged_d, typeof)
typs <- sapply(merged_d, typeof)
typs
typs[1]
as.vector(typs[1])
as.vector(typs)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
t
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
t
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
t
sapply(t, class)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
library(QPackage)
ret <- fn_1(d1, d2, fn_list)
sapply(merged_tuple, class)
sapply(merged_tuple, d1)
sapply(d1, class)
ff <- cbind(d1, d2)
sapply(ff, class)
col_types
merged_tuple
sapply(merged_tuple, class)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
classes
out
lapply(out, class)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
ret <- fn_1(d1, d2, fn_list)
merged_tuple
sapply(merged_tuple, class)
t1
t2
ret_list
ret_list
adist(NA, NA)
adist(NA, NULL)
adist(NULL, 19)
adist(NULL, "")
is.null(adist(NULL, ""))
adist(NULL, "fs")
inf - inf
Inf - Inf
Inf + Inf
Inf / Inf
Inf + 1
Inf - Inf
?cbin
?cbind
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/feature-generation.R')
ret <- apply_feat_fn_over_2tables(d1, d2, fn_list)
ret
library(QPackage)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/feature-generation.R')
ret <- apply_feat_fn_over_2tables(d1, d2, fn_list)
ret_list
ret_list
ret_list
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/feature-generation.R')
ret <- apply_feat_fn_over_2tables(d1, d2, fn_list)
ret
unlist(ret)
ret[[1]]
ret[[2]]
ret[[3]]
ret[[4]]
ret[[5]]
rr <- do.call(rbind, ret)
rr
sapply(rr, class)
rr <- as.data.frame(do.call(rbind, ret), stringsAsFactors=F)
rr
sapply(rr, class)
rr <- do.call(rbind, ret)
is.data.frame(rr)
as.data.frame(rr)
kk <- as.data.frame(rr)
kk[1, ]
kk[2, ]
kk[1:2, ]
is.data.frame(kk)
kk
sapply(kk, class)
kk$lev_brand
as.numeric(kk$lev_brand)
as.numeric(kk$jac_title_qgram2_title_qgram_2)
adist("abd", "abc")
adist("abd", NA)
adist("abd", NULL)
is.null(adist("abd", NULL))
adist(NA, "abd")
adist(NA, NA)
adist(NA, NULL)
adist(NULL, "abd")
is.null(adist(NULL, "abd"))
type(adist(NULL, "abd"))
typeof(adist(NULL, "abd"))
print(adist(NULL, "abd"))
adist(NULL, "abd") + 10
adist(NULL, "abd")[1] + 10
adist(NULL, "abd")[1]
adist(NULL, NA)[1]
adist(NULL, NULL)[1]
adist("ABD", NULL)[1]
kk
convert_types(kk, rep("numeric", 4)
)
kk1 <- convert_types(kk, rep("numeric", 4))
kk1
sapply(kk1, class)
rr
kk1 <- convert_types(rr, rep("numeric", 4))
kk1
is.data.frame(kk1)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/feature-generation.R')
ret <- apply_feat_fn_over_2tables(d1, d2, fn_list)
ret
library(QPackage)
ret <- apply_feat_fn_over_2tables(d1, d2, fn_list)
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/feature-generation.R')
ret <- apply_feat_fn_over_2tables(d1, d2, fn_list)
ret
library(rJava)
library(QPackage)
install.packages('rJava')
install.packages('rJava')
quit()
q()
?strsplit
data(bowker_bk_dataset)
b <- bowker_bk_dataset
strsplit("muruga saranam", " ")
fn <- function(s) { length(strsplit(s, " "))}
kk <- lapply(b[, "title"], fn)
kk
fn <- function(s) { length(unlist(strsplit(s, " ")))}
kk <- lapply(b[, "title"], fn)
kk
kk1 <- lapply(w[, "title"], fn)
data(walmart_bk_dataset)
w <- walmart_bk_dataset
kk1 <- lapply(w[, "title"], fn)
mean(unlist(kk1))
mean(unlist(kk))
a <- list()
b <- list()
b[[1]] <- list("jaro")
b[[2]] <- list("jaro_winkler")
b[[3]] <- list("lev")
b[[4]] <- list("soundex")
b[[5]] <- list("jaccard", "tok_qgram", 3, "tok_qgram", 3)
b[[6]] <- list("exact_match")
a[["SINGLE_WORD"]] <- b
a
a <- list()
b <- list()
b[1] <- list("jaro")
b[2] <- list("jaro_winkler")
a["sws"] <- b
a[["sws"]] <- b
a
a$sws
a$sws[[1]]
lapply(a$sws, funtion(s) { c(list("brand", "brand"), s)})
lapply(a$sws, funtion(s) { c(list("brand", "brand"), s) })
fn1 <-function(s) {c(list("brand", "brand"), s)}
lapply(a$sws, fn1)
lapply(unlist(a$sws), funtion(s) { c(list("brand", "brand"), s) })
lapply(unlist(a$sws), fn1)
ll <- lapply(unlist(a$sws), fn1)
fn3 <- function(s) { do.call(fill_fn_template(s))}
lapply(ll, fn3)
fn3 <- function(s) { do.call(fill_fn_template, s)}
lapply(ll, fn3)
ff <- lapply(ll, fn3)
fn4 <- function(s) { eval(parse(text = s))}
ff2 <- lapply(ff, fn4)
ff2
names(ff2)
rownames(ff2)
names(ff2) <- c("p1", "p2")
ff2
a
fn6 <- function(s, f) { if(! s %in% f) { return s}}
fn6 <- function(s, f) { if(! s %in% f) { return(s)}}
lapply(a$sws, fn6, c("jaro"))
nn <- lapply(a$sws, fn6, c("jaro"))
is.null(nn)
lapply(nn, na.omit)
ll[!lapply(ll,is.null)]
nn[!lapply(nn,is.null)]
lapply(nn, is.null)
!lapply(nn, is.null)
sapply(nn, is.null)
!sapply(nn, is.null)
ll[!sapply(nn, is.null)]
nn[!sapply(nn, is.null)]
__kk
__kk <- 10
kk... <- 10
kk..... <- 10
kk.. <- 10
kk... <- 10
word_len <- function(s) {
length(unlist(strsplit(s, " ")))
}
check_valid <- function(s, simlist, toklist) {
s <- unlist(s)
if(any(s %in% simlist)) {
>>>>>>> origin/master
return(NULL)
}
if(any(s %in% toklist))
return(NULL)
<<<<<<< HEAD
return(unlist(s))
}
check_valid <- function(s, simlist, toklist) {
s <- unlist(s)
if(any(s `%in%` simlist) {
return(NULL)
}
if(any(s `%in%` toklist))
return(NULL)
return(s)
}
s <- a$mws[1]
s
s <- unlist(s)
s
global_simlist <- c("jaccard, lev")
global_toklist <- c("tok_whitespace", "tok_gram")
allowed_simlist <- c("jaccard", "lev")
allowed_toklist <- c( "tok_gram")
avoid_simlist <- setdiff(global_simlist, allowed_simlist)
avoid_toklist <- setdiff(global_toklist, allowed_toklist)
s <- a$mws[2]
s
s <- unlist(s)
s %in% avoid_simlist
s %in% avoid_toklist
if(any(s %in% avoid_simlist)) { print("mur")}
if(any(s %in% avoid_toklist)) { print("mur")}
check_valid <- function(s, simlist, toklist) {
s <- unlist(s)
if(any(s %in% simlist)) {
return(NULL)
}
if(any(s %in% toklist))
return(NULL)
return(s)
}
valid_list <- lapply(mws, check_valid, avoid_simlist, avoid_toklist)
mws <- a$mws
valid_list <- lapply(mws, check_valid, avoid_simlist, avoid_toklist)
valid_list
valid_list <- valid_list[!sapply(valid_list, is.null)]
valid_list
allowed_toklist <- c( "tok_qgram")
fill_fn <- function(s, l) {
l <- unlist(l)
s <- unlist(s)
s <- list(s)
l <- list(l)
fn_str <- do.call(fill_fn_template, list(c(l, s)))
fn_obj <- eval(parse(text = fnstr))
}
lapply(valid_list, fill_fn, attrs)
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
fill_fn <- function(s, l) {
l <- unlist(l)
s <- unlist(s)
s <- list(s)
l <- list(l)
print(s)
print(l)
fn_str <- do.call(fill_fn_template, list(c(l, s)))
fn_obj <- eval(parse(text = fnstr))
}
lapply(valid_list, fill_fn, attrs)
fill_fn <- function(s, l) {
l <- unlist(l)
s <- unlist(s)
s <- list(s)
l <- list(l)
print(s)
print(l)
fn_str <- do.call(fill_fn_template, c(l, s))
fn_obj <- eval(parse(text = fnstr))
}
lapply(valid_list, fill_fn, attrs)
do.call(fill_fn_template, list("title", "title, "lev"))
do.call(fill_fn_template, list("title", "title", "lev"))
s <- list("lev")
l <- list("title", "title")
c(l, s)
do.call(fill_fn_template, c(l, s))
fill_fn <- function(s, l) {
l <- unlist(l)
s <- unlist(s)
s <- list(s)
l <- list(l)
print(s)
print(l)
fn_str <- do.call(fill_fn_template, c(l, s))
fn_obj <- eval(parse(text = fnstr))
}
lapply(valid_list, fill_fn, attrs)
fill_fn <- function(s, l) {
l <- unlist(l)
s <- unlist(s)
s <- list(s)
l <- list(l)
print(s)
print(l)
fn_str <- do.call(fill_fn_template, c(l, s))
fn_obj <- eval(parse(text = fn_str))
}
lapply(valid_list, fill_fn, attrs)
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attrs)
do.call(fill_fn_template, c(l, s))
l
c(l, s)
do.call(fill_fn_template, c(l, s))
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attrs)
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attrs)
l
lapply(l)
lapply(l, list)
lapply(unlist(l), list)
lapply(valid_list, fill_fn, attrs)
attr_list <- lapply(attrs, list)
lapply(valid_list, fill_fn, attr_list)
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attr_list)
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attr_list)
l
attr_list
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attr_list)
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attr_list)
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
debugSource('C:/Pradap/Research/R-Packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attr_list)
fns <- lapply(valid_list, fill_fn, attr_list)
fns
get_names <- function(s) {
nrow(w)
}
get_names(10)
dict["jaccard"] <- "jac"
dict["tok_whitespace"] <- "ws"
dict["tok_qgram"] <- "qgm"
dict["lev"] <- lev
dict <- list()
dict["jaccard"] <- "jac"
dict["tok_whitespace"] <- "ws"
dict["tok_qgram"] <- "qgm"
dict["lev"] <- lev
dict["lev"] <- "lev"
dict
dict[c("lev", "tok_whitespace")]
unlist(dict[c("lev", "tok_whitespace")])
dict[c("lev", NULL, "tok_whitespace")]
c(dict[c("lev", NULL, "tok_whitespace")])
paste(dict[c("lev", NULL, "tok_whitespace")], "_")
paste(dict[c("lev", NULL, "tok_whitespace")], "")
paste0(dict[c("lev", NULL, "tok_whitespace")], "")
?paste0
paste0(dict[c("lev", NULL, "tok_whitespace")], sep="_")
paste0(dict[c("lev", NULL, "tok_whitespace")], sep="")
paste0(paste0(dict[c("lev", NULL, "tok_whitespace")], sep=""), "_"
)
(paste0(dict[c("lev", NULL, "tok_whitespace")], sep="", collapse="_")
)
x <- sample(1000)
devtools::use_data(x, mtcars, internal = TRUE)
?paste0
=======
return(s)
}
fill_fn <- function(s, l) {
l <- unlist(l)
s <- unlist(s)
s <- list(s)
l <- list(l)
print(s)
print(l)
fn_str <- do.call(fill_fn_template, c(l, s))
fn_obj <- eval(parse(text = fn_str))
}
a <- list()
b <- list()
b[[1]] <- list("lev")
b[[2]] <- list("jaccard", "tok_whitespace", NULL, "tok_whitespace", NULL)
b[[3]] <- list("jaccard", "tok_qgram", 3, "tok_qgram", 3)
a$mws <- b
w <- walmart_bk_dataset
b <- bowker_bk_dataset
attr_corres = NULL
if(is.null(attr_corres)) {
c1 <- colnames(w)
c2 <- colnames(b)
cmn <- setdiff(intersect(c1, c2), c(unlist(w@key), unlist(b@key)))
attr_corres <- lapply(cmn, rep, 2)
}
global_simlist <- c("jaccard, lev")
global_toklist <- c("tok_whitespace", "tok_gram")
allowed_simlist <- c("jaccard", "lev")
allowed_toklist <- c( "tok_qgram")
attrs <- attr_corres[[1]]
if(class(w[, attrs[1]]) == class(w[, attrs[2]])) {
if(class(w[, attrs[1]] == "character")) {
len1 <- lapply(w[, attrs[1]], word_len)
len1 <- unlist(len1)
len2 <- lapply(w[, attrs[2]], word_len)
len2 <- unlist(len1)
if(mean(len1) > 5 && mean(len2) > 5) {
mws <- a$mws
avoid_simlist <- setdiff(global_simlist, allowed_simlist)
avoid_toklist <- setdiff(global_toklist, allowed_toklist)
valid_list <- lapply(mws, check_valid, avoid_simlist, avoid_toklist)
valid_list <- valid_list[!sapply(valid_list, is.null)]
attr_list <- lapply(attrs, list)
}
}
}
attrs <- attr_corres[[1]]
if(class(w[, attrs[1]]) == class(w[, attrs[2]])) {
if(class(w[, attrs[1]]) == "character") {
len1 <- lapply(w[, attrs[1]], word_len)
len1 <- unlist(len1)
len2 <- lapply(w[, attrs[2]], word_len)
len2 <- unlist(len1)
if(mean(len1) > 5 && mean(len2) > 5) {
mws <- a$mws
avoid_simlist <- setdiff(global_simlist, allowed_simlist)
avoid_toklist <- setdiff(global_toklist, allowed_toklist)
valid_list <- lapply(mws, check_valid, avoid_simlist, avoid_toklist)
valid_list <- valid_list[!sapply(valid_list, is.null)]
attr_list <- lapply(attrs, list)
}
}
}
attr_list
valid_list
attrs
lapply(valid_list, fill_fn, attr_list)
lapply(valid_list, fill_fn, attrs)
attrs
list(attrs)
fill_fn <- function(s, l) {
fn_str <- do.call(fill_fn_template, c(list(l), s))
fn_obj <- eval(parse(text = fn_str))
return(fn_obj)
}
lapply(valid_list, fill_fn, attrs)
fill_fn <- function(s, l) {
#   fn_str <- do.call(fill_fn_template, c(list(l), s))
#   fn_obj <- eval(parse(text = fn_str))
#   return(fn_obj)
print(l)
print(s)
}
lapply(valid_list, fill_fn, attrs)
fill_fn <- function(s, l) {
#   fn_str <- do.call(fill_fn_template, c(list(l), s))
#   fn_obj <- eval(parse(text = fn_str))
#   return(fn_obj)
print(l)
print(s)
print('-----')
}
lapply(valid_list, fill_fn, attrs)
valid_list
fill_fn <- function(s, l) {
fn_str <- do.call(fill_fn_template, c(list(l), list(s)))
fn_obj <- eval(parse(text = fn_str))
return(fn_obj)
}
lapply(valid_list, fill_fn, attrs)
lapply(valid_list, fill_fn, attr_list)
fill_fn <- function(s, l) {
fn_str <- do.call(fill_fn_template, c(list(l), s))
fn_obj <- eval(parse(text = fn_str))
return(fn_obj)
}
lapply(valid_list, fill_fn, attr_list)
fill_fn <- function(s, l) {
fn_str <- do.call(fill_fn_template, list(unlist(l), unlist(s)))
fn_obj <- eval(parse(text = fn_str))
return(fn_obj)
}
lapply(valid_list, fill_fn, attr_list)
source('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attr_list)
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
library(QPackage)
lapply(valid_list, fill_fn, attr_list)
l
debugSource('/scratch/pradap/r-work/r-packages/Q-RPackage/QPackage/R/test.R')
lapply(valid_list, fill_fn, attr_list)
s1
is.list(s1)
l
unlist(l)
list(s, unlist(l))
list(s1, unlist(l))
c(s1, unlist(l))
list(c(s1, unlist(l)))
list(c( unlist(l), s1))
do.call(fill_fn_template, list(c(unlist(l), s1)))
do.call(fill_fn_template, list((unlist(l), s1)))
kk <- list(s1, unlist(l))
do.call(fill_fn_template, kk)
?fill_fn_template
do.call(fill_fn_template, list("title", "title", "lev"))
kk <- list("title", "title", "lev")
kk
s1
l
unlist(l)
c(s1, unlist(l))
list(c(s1, unlist(l)))
k <- c(unlist(l), s1)
k
list(k)
attr_list
c(attr_list, l)
c(attr_list, s1)
id_fn <- function(inp) {
inp
}
attr_list <- lapply(attrs, id_fn)
attr_list
do.call(fill_fn_template, c(l, s1))
I(s)
I(attr_list)
attr_list
attr_list <- lapply(attrs, id_fn)
id_fn <- function(inp) {
inp
}
attr_list <- lapply(attrs, id_fn)
fn_objs <- lapply(valid_list, fill_fn, attr_list)
fill_fn <- function(s, l) {
fn_str <- do.call(fill_fn_template, c(l, s))
fn_obj <- eval(parse(text = fn_str))
return(fn_obj)
}
<<<<<<< Updated upstream
attr_list <- lapply(attrs, id_fn)
fn_objs <- lapply(valid_list, fill_fn, attr_list)
fn_objs
a <- list()
b <- list()
b[1] <- list("lev")
b[2] <- list("jaccard", "tok_whitespace", NULL, "tok_whitespace", NULL)
b[3] <- list("jaccard", "tok_qgram", 3, "tok_qgram", 3)
a$mws <- b
lkp_table <- list()
l1 <- list()
l1[[1]] <- list("monge_elkan")
l1[[1]] <- list("jaccard", "tok_whitespace", NULL, "tok_whitespace", NULL)
l1[[2]] <- list("jaccard", "tok_whitespace", NULL, "tok_whitespace", NULL)
l1[[1]] <- list("monge_elkan")
l1[[3]] <- list("cosine", "tok_whitespace", NULL, "tok_whitespace", NULL)
l1
lkp_table$MWM <- l1
lkp_table
lkp_table$MWM
auto_gen_table... <- lkp_table
dict <- list()
dict["jaccard"] <- "jac"
dict["tok_whitespace"] <- "ws"
dict["monge_elkan"] <- "mon_elk"
feat_lkp_names... <- dict
save(list(auto_gen_table..., feat_lkp_names...), file = sysdata.rda)
save(auto_gen_table..., feat_lkp_names..., file = "sysdata.rda")
save(auto_gen_table..., feat_lkp_names..., file = "R/sysdata.rda")
library(QPackage)
QPackage:::sysdata
QPackage:::auto_gen_table...
QPackage:::auto_gen_table...
QPackage:::auto_gen_table...
QPackage:::feat_lkp_names...
=======
cset_a_small <- cset_a[1:5, ]
cset_b_small <- cset_b[1:5, ]
fn_list <- create_features()
apply_feat_fn_over_2tables(cset_a_small, cset_b_small, fn_list)
javareconf
library(rJava)
apply_feat_fn_over_2tables(cset_a_small, cset_b_small, fn_list)
Sys.getenv('JAVA_HOME')
Sys.setenv("/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home/jre")
Sys.setenv(JAVA_HOME = "/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home/jre")
apply_feat_fn_over_2tables(cset_a_small, cset_b_small, fn_list)
library(rJava)
apply_feat_fn_over_2tables(cset_a_small, cset_b_small, fn_list)
install.packages('rJava', type='source')
install.packages("rJava", type = "source")
remove.packages("rJava")
install.packages("rJava", type = "source")
install.packages("rJava")
install.packages("rJava")
library(rJava)
print("Importing walmart data")
walmart <- read_csv("../QPackage/inst//extdata/books/walmart.csv", status = read_status)
print(read_status)
# check id
status <- check_id(walmart, list("id"))
print(status)
# set id
status <- set_id(walmart, list("id"))
print(status)
# -- bowker
print("Importing bowker data")
bowker <- read_csv("../QPackage/inst//extdata/books/bowker.csv", status = read_status)
print(read_status)
# check id
status <- check_id(bowker, list("id"))
print(status)
# set id
status <- set_id(bowker, list("id"))
print(status)
print("Importing walmart data")
walmart <- read_csv("../QPackage/inst//extdata/books/walmart.csv", status = read_status)
print(read_status)
# check id
status <- check_id(walmart, list("id"))
print(status)
# set id
status <- set_id(walmart, list("id"))
print(status)
# -- bowker
print("Importing bowker data")
bowker <- read_csv("../QPackage/inst//extdata/books/bowker.csv", status = read_status)
print(read_status)
# check id
status <- check_id(bowker, list("id"))
print(status)
# set id
status <- set_id(bowker, list("id"))
print(status)
print("Importing walmart data")
walmart <- read_csv("../QPackage/inst//extdata/books/walmart.csv", status = read_status)
print(read_status)
# check id
status <- check_id(walmart, list("id"))
print(status)
# set id
status <- set_id(walmart, list("id"))
print(status)
# -- bowker
print("Importing bowker data")
bowker <- read_csv("../QPackage/inst//extdata/books/bowker.csv", status = read_status)
print(read_status)
# check id
status <- check_id(bowker, list("id"))
print(status)
# set id
status <- set_id(bowker, list("id"))
print(status)
print("Importing walmart data")
walmart <- read_csv("../QPackage/inst//extdata/books/walmart.csv", status = read_status)
library(QPackage)
print("Importing walmart data")
walmart <- read_csv("../QPackage/inst//extdata/books/walmart.csv", status = read_status)
status <- check_id(walmart, list("id"))
status <- set_id(walmart, list("id"))
bowker <- read_csv("../QPackage/inst//extdata/books/bowker.csv", status = read_status)
status <- check_id(bowker, list("id"))
status <- set_id(bowker, list("id"))
attr1 <- "isbn"
attr2 <- "isbn"
cand_set <-  apply_block(walmart, bowker, attr_equiv_block, attr1, attr2, col_names_a = list("title", "author", "binding", "publisher", "pages"), col_names_b = list("title", "author", "binding", "publisher", "pages"))
is.integer0 <- function(x)
{
is.integer(x) && length(x) == 0L
}
keys <- unlist(cand_set@key)
tbl_a_idx <- grep("A.", keys)
if(!is.integer0(tbl_a_idx)) {
tbl_a_key <- keys[tbl_a_idx]
cset_a <- merge(walmart, cand_set, by.x = unlist(walmart@key), by.y = tbl_a_key)
}
tbl_b_idx <- grep("B.", keys)
if(!is.integer0(tbl_b_idx)) {
tbl_b_key <- keys[tbl_b_idx]
cset_b <- merge(bowker, cand_set, by.x = unlist(walmart@key), by.y = tbl_b_key)
}
cset_a_small <- cset_a[1:5, ]
cset_b_small <- cset_b[1:5, ]
fn_list <- create_features()
apply_feat_fn_over_2tables(cset_a_small, cset_b_small, fn_list)
library(rJava)
.jinit()
.jcall("java/lang/System", "S", "getProperty", "java.runtime.version")
options(java.home="/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home/jre")
library(rJava)
.jinit()
.jcall("java/lang/System", "S", "getProperty", "java.runtime.version")
options(java.home="/Library/Java/JavaVirtualMachines/jdk1.8.0_45.jdk/Contents/Home")
library(rJava)
.jinit()
.jcall("java/lang/System", "S", "getProperty", "java.runtime.version")
options("java.home")
system("java -version")
library(rJava)
.jinit()
.jcall("java/lang/System", "S", "getProperty", "java.runtime.version")
library(rJava)
library(rJava)
.jinit()
.jcall("java/lang/System", "S", "getProperty", "java.runtime.version")
install.packages("helloJavaWorls")
install.packages("helloJavaWorld")
ibrary(helloJavaWorld)
Loading required package: rJava
helloJavaWorld()
library(helloJavaWorld)
library(helloJavaWorld)
helloJavaWorld
helloJavaWorld()
apply_feat_fn_over_2tables(cset_a_small, cset_b_small, fn_list)
ibrary(helloJavaWorld)
Loading required package: rJava
library(rJava)
.jinit()
.jcall("java/lang/System", "S", "getProperty", "java.runtime.version")

